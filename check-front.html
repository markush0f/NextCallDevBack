<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Media Signaling</title>
</head>
<body>
  <h1>Test WebRTC Media Signaling</h1>
  <button onclick="sendGetRtpCapabilities()">Get RTP Capabilities</button>

  <pre id="output"></pre>

  <script>
    const meetingId = 1;
    const userId = 2;	

    const socket = new WebSocket(`ws://localhost:8080/ws/meeting/${meetingId}/${userId}`);
    
    socket.onopen = () => {
      log("🟢 Conectado al signaling-service");
    };

    socket.onmessage = (event) => {
      log("📩 Respuesta:\n" + JSON.stringify(JSON.parse(event.data), null, 2));
    };

    socket.onerror = (err) => {
      log("❌ Error: " + err.message);
    };

    function sendGetRtpCapabilities() {
      const message = {
        type: "get-rtp-capabilities",
        sender: 1,
        target: 0,         // No se está reenviando, solo respuesta directa
        payload: {}
      };
      socket.send(JSON.stringify(message));
      log("📤 Enviado: get-rtp-capabilities");
    }

    function log(text) {
      const el = document.getElementById("output");
      el.textContent += text + "\n";
    }
  </script>
</body>
</html>
